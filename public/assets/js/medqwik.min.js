/*! medqwik 10-07-2018 */

function initializeJS(){function a(a){var b=parseInt($("#puTaxIncludes_"+a).val()),d=parseFloat($("#puItemTax_"+a).val()),e=parseFloat($("#puItemRate_"+a).val()),f=calcTaxRate=0;0===parseInt(b)?(taxAmount=parseFloat(e*d/100),f=e):1===parseInt(b)&&(calcTaxRate=d/100+1,grossValue=Math.round(e/calcTaxRate*100)/100,taxAmount=Math.round(100*(e-grossValue))/100,f=grossValue),isNaN(f)&&(f=0),isNaN(taxAmount)&&(taxAmount=0),$("#puItemRate_"+a).val(f),$("#puItemTaxRate_"+a).text(taxAmount),c(a)}function b(a,b,c){var d=iTotal=billAmount=totalAmount=roundOff=0,e=jQuery("#itemtotal_"+a),f=(parseFloat(b)*parseFloat(c)).toFixed(2);jQuery(e).text(f),jQuery(".itemTotal").each(function(a,b){iTotal=jQuery(this).text(),parseFloat(iTotal)>0&&(billAmount+=parseFloat(iTotal))}),totalAmount=billAmount-0,roundOff=parseFloat(Math.round(totalAmount)-totalAmount),d=parseFloat(totalAmount+roundOff),billAmount=billAmount.toFixed(2),totalAmount=totalAmount.toFixed(2),roundOff=roundOff.toFixed(2),d=d.toFixed(2),jQuery(".billAmount").text(billAmount),jQuery(".totalAmount").text(totalAmount),jQuery(".roundOff").text(roundOff),jQuery(".netPay").text(d)}function c(a){var b=parseFloat($("#puItemRate_"+a).val()),c=parseFloat($("#puItemTaxRate_"+a).text()),e=parseFloat($("#puBillQty_"+a).text()),f=0;b>0&&e>0?(f=parseFloat((b+c)*e),$("#puItemAmount_"+a).text(f.toFixed(2)),d()):$("#puItemAmount_"+a).text("")}function d(){var a=roundOff=netPay=totalAmount=0,b=parseFloat($("#adjAmount").val());isNaN(b)&&(b=0),jQuery(".puItemAmount").each(function(b,c){iTotal=jQuery(this).text(),parseFloat(iTotal)>0&&(a+=parseFloat(iTotal))}),a>0?(totalAmount=parseFloat(a-b),roundOff=parseFloat(Math.round(totalAmount)-totalAmount),netPay=parseFloat(totalAmount+roundOff)):a=roundOff=netPay="",$(".grandTotal").text(a.toFixed(2)),$(".roundOff").text(roundOff.toFixed(2)),$(".netPay").text(netPay.toFixed(2))}function e(){var a=roundOff=netPay=0;jQuery(".itemReturnValue").each(function(b,c){iTotal=jQuery(this).text(),parseFloat(iTotal)>0&&(a+=parseFloat(iTotal))}),roundOff=parseFloat(Math.round(a)-a),netPay=parseFloat(a+roundOff),jQuery(".totalAmount").text(a.toFixed(2)),jQuery(".roundOff").text(roundOff.toFixed(2)),jQuery(".netPay").text(netPay.toFixed(2))}function f(a){return 1===parseInt(a)?"GEN":2===parseInt(a)?"IPS":3===parseInt(a)?"OPS":void 0}function g(a){var b=totalTaxAmount=finalAmount=0,c=roundedNetPay=0,d=parseFloat(returnNumber($("#inwRcvdQty_"+a).val())),e=parseFloat(returnNumber($("#inwFreeQty_"+a).val())),f=parseFloat(returnNumber($("#inwItemRate_"+a).val())),g=parseFloat(returnNumber($("#inwItemDiscount_"+a).val())),i=parseFloat(returnNumber($("#inwItemTax_"+a).val())),j=d-e,k=parseFloat(returnNumber(j*f)),l=parseFloat(returnNumber(k-g)),m=parseFloat(l*i/100).toFixed(2);$("#inwBillQty_"+a).val(j),$("#inwItemGrossAmount_"+a).val(k),$("#inwItemAmount_"+a).val(l),$("#inwItemTaxAmt_"+a).val(m),jQuery(".inwItemAmount").each(function(a,c){0===jQuery(this).val().length?iTotal=0:iTotal=parseFloat(returnNumber(jQuery(this).val())),iTotal>0&&(b+=iTotal)}),jQuery(".inwItemTaxAmount").each(function(a,b){0===jQuery(this).val().length?iTotal=0:iTotal=parseFloat(returnNumber(jQuery(this).val())),iTotal>0&&(totalTaxAmount+=iTotal)}),c=parseFloat(b+totalTaxAmount),roundedNetPay=Math.round(c),finalAmount=c-parseFloat(roundedNetPay.toFixed(2)),$("#inwItemsTotal").text(b.toFixed(2)),$("#inwItemTaxAmount").text(totalTaxAmount.toFixed(2)),$("#roundOff").text(finalAmount.toFixed(2)),$("#inwNetPay").text(roundedNetPay),h()}function h(){jQuery(".inwTaxPercents").each(function(a,b){var c=$(this).val(),d=$(this).attr("id"),e=totalTaxable=0;$("input[data-rate='"+c+"']").each(function(a,b){if(parseFloat(returnNumber($(this).val()))>0){var c=$(this).attr("id").split("_"),d=c[1],f=$("#inwItemAmount_"+d).val();totalTaxable=parseFloat(totalTaxable)+parseFloat(f),e=parseFloat(e)+parseFloat($(this).val())}}),$("#taxAmount_"+d).val(e.toFixed(2));var f=parseFloat(e/2).toFixed(2);$("#taxable_"+d+"_cgst_value").text(f),$("#taxable_"+d+"_sgst_value").text(f),$("#taxable_"+d+"_amount").text(totalTaxable)})}jQuery(".date").datepicker(),jQuery("#timepicker1").timepicker(),jQuery(".tooltips").tooltip(),jQuery(".popovers").popover(),jQuery("html").niceScroll({styler:"fb",cursorcolor:"#007AFF",cursorwidth:"6",cursorborderradius:"10px",background:"#F7F7F7",cursorborder:"",zindex:"1000"}),jQuery("#sidebar").niceScroll({styler:"fb",cursorcolor:"#007AFF",cursorwidth:"3",cursorborderradius:"10px",background:"#F7F7F7",cursorborder:""}),jQuery(".scroll-panel").niceScroll({styler:"fb",cursorcolor:"#007AFF",cursorwidth:"3",cursorborderradius:"10px",background:"#F7F7F7",cursorborder:""}),jQuery("#sidebar .sub-menu > a").click(function(){var a=jQuery(".sub-menu.open",jQuery("#sidebar"));jQuery(this).find(".menu-arrow").removeClass("arrow_carrot-right"),jQuery(".sub",a).slideUp(200);var b=jQuery(this).next();b.is(":visible")?(jQuery(this).find(".menu-arrow").addClass("arrow_carrot-right"),b.slideUp(200)):(jQuery(this).find(".menu-arrow").addClass("arrow_carrot-down"),b.slideDown(200));var c=jQuery(this).offset();diff=200-c.top,diff>0?jQuery("#sidebar").scrollTo("-="+Math.abs(diff),500):jQuery("#sidebar").scrollTo("+="+Math.abs(diff),500)}),jQuery(function(){function a(){var a=jQuery(window).width();a<=768&&(jQuery("#container").addClass("sidebar-close"),jQuery("#sidebar > ul").hide()),a>768&&(jQuery("#container").removeClass("sidebar-close"),jQuery("#sidebar > ul").show())}jQuery(window).on("load",a),jQuery(window).on("resize",a)}),jQuery(".toggle-nav").click(function(){!0===jQuery("#sidebar > ul").is(":visible")?(jQuery("#main-content").css({"margin-left":"0px"}),jQuery("#sidebar").css({"margin-left":"-180px"}),jQuery("#sidebar > ul").hide(),jQuery("#container").addClass("sidebar-closed")):(jQuery("#main-content").css({"margin-left":"180px"}),jQuery("#sidebar > ul").show(),jQuery("#sidebar").css({"margin-left":"0"}),jQuery("#container").removeClass("sidebar-closed"))});var i=[],j=jQuery("<option></option>").attr("value","xx99!!").text("Sel");if($("form").attr("autocomplete","off"),jQuery("#itemnames").length>0&&$("#itemnames").Tabledit({url:"/async/add-thr-qty",editButton:!1,deleteButton:!1,hideIdentifier:!1,columns:{identifier:[1,"mCode"],editable:[[3,"thQty"]]},onAjax:function(a,b){}}),$(".noEnterKey").on("keypress keydown keyup",function(a){13==a.keyCode&&a.preventDefault()}),$("#delSaleBill").length>0&&$("#delSaleBill").inputmask("99999999"),jQuery(".delSupplier").on("click",function(a){var b=jQuery(this).attr("sid");bootbox.confirm("Are you sure. You want to remove this Supplier?",function(a){!0===a&&(window.location.href="/suppliers/remove/"+b)})}),jQuery(".delDoctor").on("click",function(a){var b=jQuery(this).attr("sid");bootbox.confirm("Are you sure. You want to remove Doctor from app?",function(a){!0===a&&(window.location.href="/doctors/remove/"+b)})}),jQuery(".delSales").on("click",function(a){var b=jQuery(this).attr("sid");bootbox.confirm("Are you sure. You want to remove this Sales transaction?",function(a){!0===a&&(window.location.href="/sales/remove/"+b)})}),jQuery(".delSalesReturn").on("click",function(a){var b=jQuery(this).attr("rid");bootbox.confirm("Are you sure. You want to remove this Sales Return transaction?",function(a){!0===a&&(window.location.href="/sales-return/remove/"+b)})}),jQuery(".inameAc").length>0&&$(".inameAc").autocomplete("/async/itemsAc",{width:300,cacheLength:0,selectFirst:!1,minChars:2,max:0}),jQuery(".inameLc").length>0&&$(".inameLc").autocomplete("/async/itemsAc",{width:300,cacheLength:0,selectFirst:!1,minChars:2,max:0}),jQuery(".puRcvdQty").on("blur",function(a){var b=parseFloat($(this).val()),e=$(this).attr("id").split("_"),f="#puFreeQty_"+e[1],g=parseFloat($(f).val());isNaN(g)&&(g=0),isNaN(b)&&(b=0),$("#puBillQty_"+e[1]).text((b-g).toFixed(2)),c(e[1]),d()}),jQuery("#paymentMode").on("change",function(a){var b=$(this).val();"b"===b||"p"===b?$("#refInfo").show():"c"===b&&$("#refInfo").hide()}),jQuery(".puFreeQty").on("blur",function(a){var b=parseFloat($(this).val()),d=$(this).attr("id").split("_"),e="#puRcvdQty_"+d[1],f=parseFloat($(e).val());isNaN(b)&&(b=0),isNaN(f)&&(f=0),b>f?(alert("Free Qty. must be less than or equal to Received Qty."),$("#puFreeQty_"+d[1]).val(0),$("#puBillQty_"+d[1]).val(f)):($("#puBillQty_"+d[1]).val(f-b),c(d[1]))}),jQuery(".puItemRate").on("blur",function(){a($(this).attr("id").split("_")[1])}),$(".puTaxIncludes").on("change",function(){var b=$(this).attr("id").split("_");rowId=b[1],$("#puItemRate_"+rowId).val(""),alert("You need to re-enter Item rate again for this item to get new calculations effected !"),$("#puItemRate_"+rowId).focus(),a(rowId)}),jQuery(".puItemTax").on("change",function(){var a=$(this).attr("id").split("_");rowId=a[1];var b=parseFloat($(this).val()),d=parseFloat($("#puItemRate_"+rowId).val());b>=0&&(taxAmount=parseFloat(d*b/100).toFixed(2),isNaN(taxAmount)&&(taxAmount=0),$("#puItemTaxRate_"+rowId).text(taxAmount),c(rowId))}),jQuery(".inameAc").on("blur",function(a){var b=jQuery(this).val(),c=jQuery(this).attr("index"),d=$("#batchno_"+c),e=$(d).children("option").length;if(""!==b&&1===parseInt(e)){var f={itemname:b};jQuery.ajax("/async/getBatchNos",{data:f,method:"POST",success:function(a){var b=Object.keys(a).length,d=jQuery("#batchno_"+c),e=jQuery("#upp_"+c);if(b>0){var f=a.unitsPerPack;jQuery(e).text(f),jQuery(d).empty(),jQuery(d).append(j),jQuery.each(a.batch_nos,function(a,b){i[a]=b,jQuery(d).append(jQuery("<option></option>").attr("value",a).text(a))})}else jQuery(e).text("")},error:function(a){alert("An error occurred while fetching Batch Nos.")}})}}),jQuery(".landingCost").on("blur",function(a){var b=jQuery(this).val(),c=jQuery(this).attr("index"),d=$("#batchno_"+c),e=$(d).children("option").length;if(""!==b&&1===parseInt(e)){var f={itemname:b};jQuery.ajax("/async/getBatchNosWithLc",{data:f,method:"POST",success:function(a){console.log(a);var b=Object.keys(a).length,d=jQuery("#batchno_"+c),e=jQuery("#upp_"+c);if(b>0){var f=a.unitsPerPack;jQuery(e).text(f),jQuery(d).empty(),jQuery(d).append(j),jQuery.each(a.batch_nos,function(a,b){i[a]=b,jQuery(d).append(jQuery("<option></option>").attr("value",a).text(a))})}else jQuery(e).text("")},error:function(a){alert("An error occurred while fetching Batch Nos.")}})}}),jQuery(".batchNo").on("change",function(a){var c=jQuery(this).val(),d=jQuery(this).attr("index"),e=itemRate=expDate="";if("xx99!!"!==c)if(Object.keys(i[c]).length>0){if(e=i[c].availableQty,itemRate=i[c].itemRate,expDate=i[c].expDate,itemQty=jQuery("#qty_"+d+" option:selected").val(),parseInt(itemQty)>parseInt(e))return alert("Sold Qty. should be less than or equal to Available Qty."),!1;parseFloat(itemQty)>0&&parseFloat(itemRate)>0&&b(d,itemQty,itemRate)}else e="**invalid**",itemRate="**invalid**";else $("option",this).not(":eq(0)").remove(),jQuery("#iname_"+d).val(""),jQuery("#qty_"+d).val(0),jQuery("#upp_"+d).text(""),jQuery("#itemtotal_"+d).text("");jQuery("#qtyava_"+d).text(e),jQuery("#mrp_"+d).text(itemRate),jQuery("#expdate_"+d).text(expDate)}),jQuery(".itemQty").on("change",function(a){var c=jQuery(this).attr("index"),d=parseInt(jQuery(this).val()),e=parseFloat(jQuery("#mrp_"+c).text()),f=$("#batchno_"+c).val(),g=i[f].availableQty;if(parseInt(d)>parseInt(g))return $(this).val(0),alert("Sold Qty. should be less than or equal to Available Qty."),!1;parseFloat(d)>0&&parseFloat(e)>0&&b(c,d,e)}),jQuery("#poNoGrn").on("blur",function(){var a=$(this).val();""!==a&&jQuery.ajax("/async/poDetails?poNo="+a,{method:"GET",success:function(a){if(a=JSON.parse(a),"success"==a.status){var b=a.response.purchaseDetails,c=a.response.purchaseDetails.itemDetails,d=b.billAmount,e=b.roundOff,f=b.netPay,g=b.adjAmount;$("#supplierID").val(b.supplierCode),$("#paymentMethod").val(b.paymentMethod),$("#creditDays").val(b.creditDays),$("#grandTotal").text(d),$("#roundOff").text(e),$("#netPay").text(f),$("#adjAmount").text(g),$.each(c,function(a,c){var d=parseInt(c.itemQty),e=parseInt(c.freeQty),f=d-e,g=c.itemCode,h=parseFloat(f)*parseFloat(c.itemRate);h+=parseFloat(h)*parseFloat(c.vatPercent)/100,$("#grnItemName_"+a).text(c.itemName),$("#grnRcvdQty_"+a).html("<b>"+d+"</b> ("+e+")"),$("#grnBatchNo_"+a).text(c.batchNo),$("#grnExpDate_"+a).text(c.expdateMonth+"/"+c.expdateYear),$("#grnMrp_"+a).text(c.mrp),$("#grnItemRate_"+a).text(c.itemRate),$("#grnTaxRate_"+a).text(c.vatPercent),$("#grnItemAmount_"+a).text(h.toFixed(2)),$("#grnAccQty_"+a).val(d),$("#poCode").val(b.purchaseCode),$('<input type="hidden">').attr({name:"grnItems[]",value:g}).appendTo("#grnForm")})}else{for(key=0;key<25;key++)$("#grnItemName_"+key).text(""),$("#grnRcvdQty_"+key).text(""),$("#grnBatchNo_"+key).text(""),$("#grnExpDate_"+key).text(""),$("#grnMrp_"+key).text(""),$("#grnItemRate_"+key).text(""),$("#grnTaxRate_"+key).text("");alert("Invalid PO NO.")}},error:function(a){alert("Invalid PO No.")}})}),jQuery("#adjAmount").on("blur",function(){d()}),$("#qTaxPercent").on("change",function(){if(""!==$(this).val())var a=$(this).val();else var a=0;$(".puItemTax").each(function(b,d){$("#puItemTax_"+b).val(a),c(b)})}),$("#qRateIncludesTax").on("change",function(){if(""!==$(this).val())var a=$(this).val();else var a=0;$(".puTaxIncludes").each(function(b,c){$(this).val(a)})}),$(".puExpDate").inputmask("99/99"),$("#gstNo").length>0&&$("#gstNo").inputmask("99**********9Z9"),$("#reportsFilter").on("click",function(a){a.preventDefault(),$("#reportsForm").submit()}),$("#reportsReset").on("click",function(a){a.preventDefault();var b=$("#reportHook").val();window.location.href="/report-options"+b}),$(".returnQty").on("change",function(a){var b=$(this).attr("id").split("_")[1],c=parseFloat($("#returnRate_"+b).text()),d=parseFloat($(this).val()),f=parseFloat(c*d);$("#returnValue_"+b).text(f.toFixed(2)),e()}),$("#registrationNo").on("blur",function(a){var b=$(this).val();""!==b&&jQuery.ajax("/async/getPatientDetails?refNo="+b,{method:"GET",success:function(a){Object.keys(a).length>0&&($("#name").val(a.patientName),$("#age").val(a.age),$("#ageCategory").val(a.ageCategory),$("#gender").val(a.gender),$("#mobileNo").val(a.mobileNo),$("#saleType").val(f(a.regType)))},error:function(a){alert("An error occurred while fetching Patient Details")}})}),$("#mobileNo").on("blur",function(a){var b=$(this).val();""!==b&&jQuery.ajax("/async/getPatientDetails?refNo="+b+"&by=mobile",{method:"GET",success:function(a){Object.keys(a).length>0?($("#name").val(a.patientName),$("#age").val(a.age),$("#ageCategory").val(a.ageCategory),$("#gender").val(a.gender),$("#mobileNo").val(a.mobileNo),$("#saleType").val(f(a.regType)),$("#registrationNo").val(a.refNumber)):($("#name").val(""),$("#age").val(0),$("#ageCategory").val("years"),$("#gender").val("m"),$("#saleType").val("GEN"),$("#registrationNo").val(""))},error:function(a){alert("An error occurred while fetching Patient Details")}})}),$("#expiryForm #month").on("change",function(a){a.preventDefault();var b=$(this).val(),c=$("#expiryForm #year").val(),d="/inventory/trash-expired-items?month="+b+"&year="+c;window.location.href=d}),$(".mmovement").on("change",function(a){"slow"===$(this).val()?($("#count").val(1),$("#count").attr("disabled",!0)):"fast"===$(this).val()&&($("#count").val(0),$("#count").attr("disabled",!1))}),$(".puExpDate").inputmask("99/99"),$("#dbContainer").length>0){jQuery.ajax("/async/day-sales",{method:"GET",success:function(a){if("success"===a.status){var b=a.response.daySales[0],c=parseInt(b.cashSales),d=parseInt(b.creditSales),e=parseInt(b.cardSales),f=parseInt(b.returnamount),g=parseInt(c+d+e),h=parseInt(g-f),i=c-f;$("#ds-cashsale").text(c.toFixed(2)),$("#ds-cardsale").text(e.toFixed(2)),$("#ds-creditsale").text(d.toFixed(2)),$("#ds-totals").text(g.toFixed(2)),$("#ds-returns").text(f.toFixed(2)),$("#ds-netsale").text(h.toFixed(2)),$("#ds-cashinhand").text(i.toFixed(2))}},error:function(a){alert("An error occurred while fetching Day Sales")}})}$("#sfGraphReload").on("click",function(a){var b=$("#sgf-month").val(),c=$("#sgf-year").val();$("#saleMonth").val(b),$("#saleYear").val(c),monthWiseSales()}),$("#inwardEntryForm").length>0&&(jQuery(".inwRcvdQty, .inwFreeQty, .inwItemRate, .inwItemDiscount").on("blur",function(a){g($(this).attr("id").split("_")[1])}),jQuery(".inwItemTax").on("change",function(){var a=$(this).attr("id").split("_"),b=a[1];$("#inwItemTaxAmt_"+b).attr("data-rate",parseFloat($(this).val()).toFixed(2)),g(b)}),jQuery("#supplierID").on("change",function(a){var b=$(this).val();jQuery.ajax("/async/get-supplier-details?c="+b,{method:"GET",success:function(a){if("success"===a.status){var b=a.response.supplierDetails,c=$("#cs").val();$("#supplierState").val(b.stateCode),$("#supplierGSTNo").val(b.tinNo),c==b.stateCode?$("#supplyType").val("intra"):$("#supplyType").val("inter")}},error:function(a){alert("An error occurred while fetching Supplier Information.")}})}),jQuery("#inwCancel").on("click",function(a){if(1!=confirm("Are you sure. You want to close this page?"))return!1;window.location.href="/purchase/list",a.preventDefault()})),$("#sendOtpBtn").length>0&&($("#sendOtpBtn").on("click",function(){sendOTP()}),$("#submit-fp").on("click",function(a){var b=$("#emailID").val(),c=$("#pass-fp").val(),d=$("#newpass-fp").val();if(""===b||""===c||""===d)return alert("Userid, OTP and New password fields are mandatory to Reset your password."),$("#emailID").focus(),!1;jQuery.ajax("/reset-password",{method:"POST",data:$("#forgotPassword").serialize(),success:function(a){!1===a.status?(alert(a.error),window.location.href="/forgot-password"):(alert("Password has been changed successfully."),window.location.href="/login")},error:function(a){alert("Unable to reset password. Please try again."),window.location.href="/forgot-password"}}),a.preventDefault()})),$("#uploadInventory").length>0&&$("#uploadInventory").on("click",function(a){if(!$("#fileName").val().length)return alert("Please choose a file to upload."),!1;$(this).attr("disabled",!0),$("#invRefresh").attr("disabled",!0),$("#reloadInfo").show(),$("#frmInventoryUpload").submit(),a.preventDefault()})}function sendOTP(a){if(!/^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,4})+$/.test($("#emailID").val()))return $("#emailID").focus(),alert("Please enter a valid username."),!1;jQuery.ajax("/send-otp",{method:"POST",data:$("#forgotPassword").serialize(),success:function(b){if(!1===b.status)return alert(b.message),!1;!0===b.status?($("#success-msg-fp").show(),$("#success-msg-fp").html(b.message),$("#pass-fp").attr("disabled",!1),$("#submit-fp").attr("disabled",!1),$("#newpass-fp").attr("disabled",!1),$("#sendOtpBtn").attr("disabled",!0),"resend"===a&&alert("OTP has been resent successfully. Please use latest code to reset your password.")):($("#error-msg-fp").show(),$("#error-msg-fp").html(b.message),"resend"===a&&alert("Unable to resend OTP."))},error:function(a){return $("#emailID").focus(),alert("An error occurred while processing your request."),!1}})}function fetchInwardItemHistory(a){var b=$("#itemName_"+a).val(),c=$("#batchNo_"+a).val();b.length>0&&0===parseInt(c.length)&&jQuery.ajax("/async/check-inward-item",{method:"POST",data:"iN="+b,success:function(b){if("success"===b.status){var c=b.response.history[0];$("#batchNo_"+a).val(c.batchNo.split("_")[1]),$("#expDate_"+a).val(c.expdateMonth+"/"+c.expdateYear),$("#mrp_"+a).val(c.mrp),$("#inwItemRate_"+a).val(c.itemRate),$("#inwItemTax_"+a).val(parseInt(c.taxPercent))}},error:function(a){alert("Unable to fetch updated information. Please try again.")}})}function printSalesBill(a){var b="/print-sales-bill?billNo="+a;window.open(b,"_blank","scrollbars=yes,titlebar=yes,resizable=yes,width=400,height=400")}function printSalesBillSmall(a){var b="/print-sales-bill-small?billNo="+a;window.open(b,"_blank","scrollbars=yes,titlebar=yes,resizable=yes,width=400,height=400")}function printSalesBillGST(a){var b="/print-sales-bill-gst?billNo="+a;window.open(b,"_blank","scrollbars=yes,titlebar=yes,resizable=yes,width=400,height=400")}function printGrn(a){var b="/print-grn/"+a;window.open(b,"_blank","scrollbars=yes,titlebar=yes,resizable=yes,width=400,height=400")}function printSalesReturnBill(a){var b="/print-sales-return-bill?returnCode="+a;window.open(b,"_blank","scrollbars=yes, titlebar=yes, resizable=yes, width=400, height=400")}function resetFilter(a){""!==a&&(window.location.href=a)}function monthWiseSales(){var a=$("#saleMonth").val(),b=$("#saleYear").val(),c=[],d=[],e=totCreditSales=totCardSales=totSales=totSalesReturns=totNetSales=0;jQuery.ajax("/async/monthly-sales?saleMonth="+a+"&saleYear="+b,{method:"GET",success:function(a){"success"===a.status&&(jQuery.each(a.response.daywiseSales,function(a,b){var f=new Date(b.tranDate+"T12:00:30z"),g=parseInt(b.cardSales)+parseInt(b.cashSales)+parseInt(b.creditSales);c.push(f.getDate()),d.push(g),e+=parseFloat(b.cashSales),totCardSales+=parseFloat(b.cardSales),totCreditSales+=parseFloat(b.creditSales),totSales+=parseFloat(b.cashSales)+parseFloat(b.cardSales)+parseFloat(b.creditSales),totSalesReturns+=parseFloat(b.returnamount)}),totNetSales=parseFloat(totSales)-parseFloat(totSalesReturns),$("#cs-cashsale").text(e.toFixed(2)),$("#cs-cardsale").text(totCardSales.toFixed(2)),$("#cs-creditsale").text(totCreditSales.toFixed(2)),$("#cs-totals").text(totSales.toFixed(2)),$("#cs-returns").text(totSalesReturns.toFixed(2)),$("#cs-netsale").text(totNetSales.toFixed(2))),$("#salesGraph").empty(),$("#salesGraph").jqplot([d,c],{title:"",seriesDefaults:{showMarker:!0,renderer:$.jqplot.BarRenderer,pointLabels:{show:!0},rendererOptions:{varyBarColor:!0},showLine:!0},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:[]},yaxis:{showTicks:!0}},grid:{drawBorder:!1,shadow:!1}})},error:function(a){alert("An error occurred while loading Monthwise Sales")}})}function returnNumber(a){return isNaN(a)||0===a.length?0:a}$(window).load(function(){$(".se-pre-con").fadeOut("slow")}),jQuery(document).ready(function(){initializeJS(),$("#dbContainer").length>0&&($("#monthwiseSales").length>0||$("#salesDayGraph").length>0)&&monthWiseSales()});